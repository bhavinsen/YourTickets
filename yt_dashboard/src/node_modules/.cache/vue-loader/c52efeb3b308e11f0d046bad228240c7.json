{"remainingRequest":"/usr/local/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/martijn/Documents/projects/yourtickets/yourticketsgit/yourtickets/yt_dashboard/src/views/Multishop.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/martijn/Documents/projects/yourtickets/yourticketsgit/yourtickets/yt_dashboard/src/views/Multishop.vue","mtime":1618405950340},{"path":"/usr/local/lib/node_modules/@vue/cli-service-global/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/usr/local/lib/node_modules/@vue/cli-service-global/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdNdWx0aXNob3AnLAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLnJlZnJlc2hUYWJsZSgpOwoKICB9LAogIGNvbXB1dGVkOiB7CiAgICBmb3JtVGl0bGUgKCkgewogICAgICByZXR1cm4gdGhpcy5sYXlvdXQuZWRpdGVkSW5kZXggPT09IC0xID8gJ0NyZWF0ZSBuZXcgbXVsdGkgdGlja2V0c2hvcCcgOiAnRWRpdCBtdWx0aSB0aWNrZXRzaG9wJwogICAgfSwKICB9LAogIG1ldGhvZHM6ewogICAgcmVxdWVzdF91cmwoaXRlbSl7CiAgICAgIHRoaXMubGF5b3V0LnNob3J0dXJsX2RpYWxvZyA9IHRydWU7CiAgICAgIGNvbnNvbGUubG9nKGl0ZW0pCiAgICAgIHRoaXMubGF5b3V0LnNob3J0dXJsX2lkID0gaXRlbS5pZAogICAgICAvLyBjb25zb2xlLmxvZyhpdGVtKQogICAgfSwKICAgIHJlcXVlc3RfdXJsX29rKCl7CiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtdWx0aXRpY2tldHNob3BzL3JlcXVlc3RfdXJsJywgewogICAgICAgICdtdWx0aXRpY2tldHNob3BfaWQnOiB0aGlzLmxheW91dC5zaG9ydHVybF9pZCwKICAgICAgICAndXJsX25hbWUnOiB0aGlzLmxheW91dC5zaG9ydHVybF9uYW1lCiAgICAgIH0pCiAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHRoaXMubGF5b3V0LnNob3J0dXJsX2RpYWxvZyA9IGZhbHNlCiAgICAgICAgICB9KQogICAgICAgICAgLmZpbmFsbHkoKCkgPT4gdGhpcy5sb2FkaW5nID0gZmFsc2UpCiAgICB9LAogICAgcmVmcmVzaFRhYmxlKCl7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgdGhpcy4kc3RvcmUuZ2V0dGVyc1snbXVsdGl0aWNrZXRzaG9wcy9nZXRhbGwnXQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5tdWx0aXRpY2tldHNob3BzID0gcmVzcG9uc2UuZGF0YS5tdWx0aXNob3BzCgogICAgICAgIH0pCiAgICAgICAgLmZpbmFsbHkoKCkgPT4gdGhpcy5sb2FkaW5nPWZhbHNlKQogICAgfSwKICAgIGRlbGV0ZU11bHRpc2hvcChpdGVtKXsKICAgICAgdGhpcy5sYXlvdXQuZWRpdGVkSW5kZXggPSB0aGlzLm11bHRpdGlja2V0c2hvcHMuaW5kZXhPZihpdGVtKQogICAgICB0aGlzLmxheW91dC5lZGl0ZWRJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSkKICAgICAgdGhpcy5sYXlvdXQuZGVsZXRlX2RpYWxvZyA9IHRydWUKICAgIH0sCiAgICBjbG9zZURlbGV0ZSAoKSB7CiAgICAgIHRoaXMubGF5b3V0LmRlbGV0ZV9kaWFsb2cgPSBmYWxzZQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy5sYXlvdXQuZWRpdGVkSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMubGF5b3V0LmRlZmF1bHRJdGVtKQogICAgICAgIHRoaXMubGF5b3V0LmVkaXRlZEluZGV4ID0gLTEKICAgICAgfSkKICAgIH0sCiAgICBkZWxldGVDb25maXJtKCl7CgogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbXVsdGl0aWNrZXRzaG9wcy9kZWxldGUnLCB7CiAgICAgICAgJ211bHRpdGlja2V0c2hvcF9pZCc6IHRoaXMubGF5b3V0LmVkaXRlZEl0ZW0uaWQKICAgICAgfSkKICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMubXVsdGl0aWNrZXRzaG9wcy5zcGxpY2UodGhpcy5sYXlvdXQuZWRpdGVkSW5kZXgsIDEpCiAgICAgICAgdGhpcy5jbG9zZURlbGV0ZSgpCiAgICAgIH0pCiAgICAgIC5maW5hbGx5KCgpID0+IHRoaXMubG9hZGluZyA9IGZhbHNlKQoKICAgIH0sCiAgICBjcmVhdGVNdWx0aXNob3AoKXsKICAgICAgdGhpcy5sYXlvdXQuZWRpdGVkSW5kZXggPSAtMTsKICAgICAgdGhpcy5sYXlvdXQuZWRpdF9kaWFsb2cgPSB0cnVlCiAgICAgIHRoaXMubGF5b3V0LnNlbGVjdGVkX2V2ZW50cyA9IFtdCgoKICAgICAgdGhpcy4kc3RvcmUuZ2V0dGVyc1snbXVsdGl0aWNrZXRzaG9wcy9nZXRldmVudHMnXQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5sYXlvdXQuZXZlbnRzID0gcmVzcG9uc2UuZGF0YS5ldmVudHMKICAgICAgICB9KQogICAgICAgIC5maW5hbGx5KCgpID0+IHRoaXMubG9hZGluZyA9IGZhbHNlKQogICAgfSwKICAgIGVkaXRNdWx0aXNob3AoaXRlbSl7CiAgICAgIHRoaXMubGF5b3V0LmVkaXRfZGlhbG9nID0gdHJ1ZTsKICAgICAgdGhpcy5sYXlvdXQuZWRpdGVkSW5kZXggPSB0aGlzLm11bHRpdGlja2V0c2hvcHMuaW5kZXhPZihpdGVtKQogICAgICB0aGlzLmxheW91dC5lZGl0ZWRJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSkKCiAgICAgIHRoaXMuJHN0b3JlLmdldHRlcnNbJ211bHRpdGlja2V0c2hvcHMvZ2V0RXZlbnRzRm9yU2hvcCddKGl0ZW0uaWQpCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CgogICAgICAgICAgdGhpcy4kc3RvcmUuZ2V0dGVyc1snbXVsdGl0aWNrZXRzaG9wcy9nZXRldmVudHMnXQogICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZTIpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMubGF5b3V0LmV2ZW50cyA9IHJlc3BvbnNlMi5kYXRhLmV2ZW50cwogICAgICAgICAgICAgICAgdGhpcy5sYXlvdXQuc2VsZWN0ZWRfZXZlbnRzID0gcmVzcG9uc2UuZGF0YS5ldmVudHMKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHRoaXMubG9hZGluZyA9IGZhbHNlKQogICAgICAgIH0pCiAgICAgICAgLmZpbmFsbHkoKCkgPT4gdGhpcy5sb2FkaW5nID0gZmFsc2UpCiAgICB9LAogICAgc2F2ZSgpewogICAgICBpZiAodGhpcy5sYXlvdXQuZWRpdGVkSW5kZXggPT09IC0xKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ211bHRpdGlja2V0c2hvcHMvY3JlYXRlJywgewogICAgICAgICAgLy8nbXVsdGl0aWNrZXRzaG9wc19pZCc6IHRoaXMuJHJvdXRlLnBhcmFtcy5pZCwKICAgICAgICAgICduYW1lJzogdGhpcy5sYXlvdXQuZWRpdGVkSXRlbS5uYW1lLAogICAgICAgICAgJ2V2ZW50cyc6IHRoaXMubGF5b3V0LnNlbGVjdGVkX2V2ZW50cwogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy5yZWZyZXNoVGFibGUoKTsKICAgICAgICAgIHRoaXMubGF5b3V0LmVkaXRfZGlhbG9nID0gZmFsc2UKICAgICAgICB9KQogICAgICAgIC5maW5hbGx5KCgpID0+IHRoaXMubG9hZGluZyA9IGZhbHNlKQoKICAgICAgfWVsc2V7CgogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtdWx0aXRpY2tldHNob3BzL3VwZGF0ZScsIHsKICAgICAgICAgICdtdWx0aXRpY2tldHNob3BfaWQnOiB0aGlzLmxheW91dC5lZGl0ZWRJdGVtLmlkLAogICAgICAgICAgJ25hbWUnOiB0aGlzLmxheW91dC5lZGl0ZWRJdGVtLm5hbWUsCiAgICAgICAgICAnZXZlbnRzJzogdGhpcy5sYXlvdXQuc2VsZWN0ZWRfZXZlbnRzCiAgICAgICAgfSkKICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAvLyBPYmplY3QuYXNzaWduKHRoaXMubXVsdGl0aWNrZXRzaG9wc1t0aGlzLmxheW91dC5lZGl0ZWRJbmRleF0sIHRoaXMubGF5b3V0LmVkaXRlZEl0ZW0pCgogICAgICAgICAgdGhpcy5sYXlvdXQuZWRpdGVkSW5kZXggPSAtMTsKCiAgICAgICAgICB0aGlzLnJlZnJlc2hUYWJsZSgpOwogICAgICAgICAgdGhpcy5sYXlvdXQuZWRpdF9kaWFsb2cgPSBmYWxzZQogICAgICAgIH0pCiAgICAgICAgLmZpbmFsbHkoKCkgPT4gdGhpcy5sb2FkaW5nID0gZmFsc2UpCiAgICAgIH0KCiAgICB9CiAgfSwKICBkYXRhOiAoKT0+KHsKICAgIGxheW91dDp7CiAgICAgIGRlbGV0ZV9kaWFsb2c6ZmFsc2UsCiAgICAgIGVkaXRfZGlhbG9nOmZhbHNlLAogICAgICBzaG9ydHVybF9kaWFsb2c6IGZhbHNlLAogICAgICBzaG9ydHVybF9uYW1lOicnLAogICAgICBzaG9ydHVybF9pZDowLAoKICAgICAgZWRpdGVkSW5kZXg6IC0xLAogICAgICBldmVudHM6W10sCiAgICAgIHNlbGVjdGVkX2V2ZW50czpbXSwKICAgICAgZWRpdGVkSXRlbTogewogICAgICAgIG5hbWU6ICcnLAogICAgICB9LAogICAgICBkZWZhdWx0SXRlbTogewogICAgICAgIG5hbWU6ICcnLAogICAgICB9LAogICAgfSwKCiAgICBsb2FkaW5nOmZhbHNlLAogICAgaGVhZGVyczpbCiAgICAgIHsgdGV4dDogJ1Nob3AgbmFtZScsIHZhbHVlOiAnbmFtZScgfSwKICAgICAgeyB0ZXh0OiAnRXZlbnRzJywgdmFsdWU6ICd0b3RhbF9ldmVudHMnIH0sCiAgICAgIHsgdGV4dDogJ1Nob3J0IHVybCcsIHZhbHVlOiAndXJsJyB9LAogICAgICB7IHRleHQ6ICdBY3Rpb25zJywgdmFsdWU6ICdhY3Rpb25zJywgc29ydGFibGU6IGZhbHNlIH0sCiAgICBdLAogICAgbXVsdGl0aWNrZXRzaG9wczpbXSwKICB9KQp9Cg=="},{"version":3,"sources":["Multishop.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Multishop.vue","sourceRoot":"views","sourcesContent":["<template>\n\n  <v-card>\n\n    <v-card-title class=\"blue white--text\">\n      <span class=\"headline\">Multi ticketshops</span>\n      <v-spacer></v-spacer>\n      <v-btn color=\"white\" @click=\"createMultishop\" >Create multi ticketshop</v-btn>\n    </v-card-title>\n\n    <v-dialog v-model=\"layout.delete_dialog\" max-width=\"500px\">\n      <v-card>\n        <v-card-title class=\"headline\">Are you sure you want to delete this?</v-card-title>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"blue darken-1\" text @click=\"closeDelete\">Cancel</v-btn>\n          <v-btn color=\"blue darken-1\" text @click=\"deleteConfirm\">OK</v-btn>\n          <v-spacer></v-spacer>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n\n    <v-dialog\n        v-model=\"layout.edit_dialog\"\n        max-width=\"600px\"\n    >\n      <v-card>\n        <v-card-title>{{formTitle}}</v-card-title>\n        <v-card-text>\n          <v-text-field v-model=\"layout.editedItem.name\" label=\"Channel name\"></v-text-field>\n          <v-select\n              v-model=\"layout.selected_events\"\n              :items=\"layout.events\"\n              item-text=\"title\"\n              item-value=\"id\"\n              :menu-props=\"{ maxHeight: '400' }\"\n              label=\"Select\"\n              multiple\n              hint=\"Pick the event for this multishop\"\n              persistent-hint\n          ></v-select>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"primary\" @click=\"save\">Opslaan</v-btn>\n        </v-card-actions>\n      </v-card>\n\n    </v-dialog>\n\n    <v-dialog\n        v-model=\"layout.shorturl_dialog\"\n        max-width=\"600px\"\n    >\n      <v-card>\n        <v-card-title>Request short url</v-card-title>\n        <v-card-text>\n          <v-text-field v-model=\"layout.shorturl_name\" prefix=\"https://www.yourtickets.nl/\"></v-text-field>\n\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"blue darken-1\" text @click=\"layout.shorturl_dialog = false\">Cancel</v-btn>\n          <v-btn color=\"primary\" @click=\"request_url_ok\">Request</v-btn>\n        </v-card-actions>\n      </v-card>\n\n    </v-dialog>\n\n\n    <v-data-table\n        :headers=\"headers\"\n        :items=\"multiticketshops\"\n        item-key=\"id\"\n        :loading=\"loading\"\n    >\n\n      <template v-slot:item.url=\"{ item }\">\n        <v-btn v-if=\"!item.url\" small @click=\"request_url(item)\">Request url</v-btn>\n        <template v-else>/{{item.url}}</template>\n      </template>\n\n      <template v-slot:item.actions=\"{ item }\">\n        <v-icon small class=\"mr-2\" @click=\"editMultishop(item)\">mdi-pencil</v-icon>\n        <v-icon small @click=\"deleteMultishop(item)\">mdi-delete</v-icon>\n      </template>\n    </v-data-table>\n\n\n  </v-card>\n\n</template>\n\n<script>\n\n\nexport default {\n  name: 'Multishop',\n  mounted() {\n    this.refreshTable();\n\n  },\n  computed: {\n    formTitle () {\n      return this.layout.editedIndex === -1 ? 'Create new multi ticketshop' : 'Edit multi ticketshop'\n    },\n  },\n  methods:{\n    request_url(item){\n      this.layout.shorturl_dialog = true;\n      console.log(item)\n      this.layout.shorturl_id = item.id\n      // console.log(item)\n    },\n    request_url_ok(){\n      this.$store.dispatch('multiticketshops/request_url', {\n        'multiticketshop_id': this.layout.shorturl_id,\n        'url_name': this.layout.shorturl_name\n      })\n          .then(() => {\n            this.layout.shorturl_dialog = false\n          })\n          .finally(() => this.loading = false)\n    },\n    refreshTable(){\n      this.loading = true\n      this.$store.getters['multiticketshops/getall']\n        .then((response) => {\n          this.multiticketshops = response.data.multishops\n\n        })\n        .finally(() => this.loading=false)\n    },\n    deleteMultishop(item){\n      this.layout.editedIndex = this.multiticketshops.indexOf(item)\n      this.layout.editedItem = Object.assign({}, item)\n      this.layout.delete_dialog = true\n    },\n    closeDelete () {\n      this.layout.delete_dialog = false\n      this.$nextTick(() => {\n        this.layout.editedItem = Object.assign({}, this.layout.defaultItem)\n        this.layout.editedIndex = -1\n      })\n    },\n    deleteConfirm(){\n\n      this.$store.dispatch('multiticketshops/delete', {\n        'multiticketshop_id': this.layout.editedItem.id\n      })\n      .then(() => {\n        this.multiticketshops.splice(this.layout.editedIndex, 1)\n        this.closeDelete()\n      })\n      .finally(() => this.loading = false)\n\n    },\n    createMultishop(){\n      this.layout.editedIndex = -1;\n      this.layout.edit_dialog = true\n      this.layout.selected_events = []\n\n\n      this.$store.getters['multiticketshops/getevents']\n        .then((response) => {\n          this.layout.events = response.data.events\n        })\n        .finally(() => this.loading = false)\n    },\n    editMultishop(item){\n      this.layout.edit_dialog = true;\n      this.layout.editedIndex = this.multiticketshops.indexOf(item)\n      this.layout.editedItem = Object.assign({}, item)\n\n      this.$store.getters['multiticketshops/getEventsForShop'](item.id)\n        .then((response) => {\n\n          this.$store.getters['multiticketshops/getevents']\n              .then((response2) => {\n                this.layout.events = response2.data.events\n                this.layout.selected_events = response.data.events\n              })\n              .finally(() => this.loading = false)\n        })\n        .finally(() => this.loading = false)\n    },\n    save(){\n      if (this.layout.editedIndex === -1) {\n        this.$store.dispatch('multiticketshops/create', {\n          //'multiticketshops_id': this.$route.params.id,\n          'name': this.layout.editedItem.name,\n          'events': this.layout.selected_events\n        })\n        .then(() => {\n          this.refreshTable();\n          this.layout.edit_dialog = false\n        })\n        .finally(() => this.loading = false)\n\n      }else{\n\n        this.$store.dispatch('multiticketshops/update', {\n          'multiticketshop_id': this.layout.editedItem.id,\n          'name': this.layout.editedItem.name,\n          'events': this.layout.selected_events\n        })\n        .then(() => {\n          // Object.assign(this.multiticketshops[this.layout.editedIndex], this.layout.editedItem)\n\n          this.layout.editedIndex = -1;\n\n          this.refreshTable();\n          this.layout.edit_dialog = false\n        })\n        .finally(() => this.loading = false)\n      }\n\n    }\n  },\n  data: ()=>({\n    layout:{\n      delete_dialog:false,\n      edit_dialog:false,\n      shorturl_dialog: false,\n      shorturl_name:'',\n      shorturl_id:0,\n\n      editedIndex: -1,\n      events:[],\n      selected_events:[],\n      editedItem: {\n        name: '',\n      },\n      defaultItem: {\n        name: '',\n      },\n    },\n\n    loading:false,\n    headers:[\n      { text: 'Shop name', value: 'name' },\n      { text: 'Events', value: 'total_events' },\n      { text: 'Short url', value: 'url' },\n      { text: 'Actions', value: 'actions', sortable: false },\n    ],\n    multiticketshops:[],\n  })\n}\n</script>\n"]}]}